<!DOCTYPE html>
<html>
<head>
  <style>
    canvas {
      background-color: #333;
      cursor: pointer;
    }
    button {
      margin: 10px;
      padding: 10px;
      background-color: #3498db;
      color: #fff;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>

<canvas id="canvas" width="600" height="600"></canvas>
<button id="startBtn">Start</button>

<button id="resetBtn">Reset</button>
<div id="instructions">Drag the wheel to set the start number.</div>
<label for="manualSpeedInput">Manual Speed (0.01 - 10.0):</label>
<input type="number" id="manualSpeedInput" step="0.01" min="0.01" max="10.0" value="0.01">
<button id="clockwiseBtn">Clockwise</button>
<button id="counterclockwiseBtn">Counterclockwise</button>
<div id="winMessage" style="display: none;">You won: <span id="prizeAmount"></span></div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const width = canvas.width;
const height = canvas.height;
const radius = Math.min(width, height) * 0.4;
ctx.translate(width / 2, height / 2);

const numbers = [40, 1, 2, 1, 2, 5, 1, 2, 10, 1, 100, 1, 5, 2, 1, 20, 1, 2, 1, 5, 1, 10, 1, 2, 5, 1, 2, 1, 2, 5, 1, 2, 1, 2, 10, 1, 700, 1, 2, 1, 20, 1, 2, 5, 1, 2, 1, 10, 1, 5, 1, 2];

let spinSpeed = 0.01; // Initial spin speed (can be adjusted by the user)
const pinWidth = 10;
let spinning = false;
let angle = 0;
let isDragging = false;
let startAngle = 0;
let decreaseRate = 0.0001; // Adjust the decrease rate (speed reduction per millisecond)
let clockwise = true; // Initial rotation direction

document.getElementById("startBtn").addEventListener("click", () => {
  if (!spinning) {
    const manualSpeed = parseFloat(document.getElementById("manualSpeedInput").value);
    if (!isNaN(manualSpeed)) {
      spinSpeed = manualSpeed;
      showWinMessage(numbers[getWinningNumber()]); // Show the prize immediately
      spinning = true;
      spinWheel();
    }
  }
});



document.getElementById("resetBtn").addEventListener("click", () => {
  angle = 0;
  drawWheel(angle);
  spinning = false;
  hideWinMessage();
});

document.getElementById("clockwiseBtn").addEventListener("click", () => {
  clockwise = true;
});

document.getElementById("counterclockwiseBtn").addEventListener("click", () => {
  clockwise = false;
});

canvas.addEventListener("mousedown", (e) => {
  if (!spinning) {
    isDragging = true;
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left - width / 2;
    const y = e.clientY - rect.top - height / 2;
    startAngle = Math.atan2(y, x) - angle;
  }
});

canvas.addEventListener("mousemove", (e) => {
  if (isDragging && !spinning) {
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left - width / 2;
    const y = e.clientY - rect.top - height / 2;
    angle = Math.atan2(y, x) - startAngle;
    drawWheel(angle);
  }
});

canvas.addEventListener("mouseup", () => {
  isDragging = false;
});

function spinWheel() {
  if (!spinning) return;

  angle += clockwise ? spinSpeed : -spinSpeed; // Adjust for clockwise or counterclockwise
  drawWheel(angle);

  // Decrease the spin speed gradually
  spinSpeed -= decreaseRate;

  if (spinSpeed <= 0) {
    spinSpeed = 0;
    spinning = false;
    showWinMessage(numbers[getWinningNumber()]);
  } else {
    requestAnimationFrame(spinWheel);
  }
}

function drawWheel(rotation) {
  ctx.clearRect(-width / 2, -height / 2, width, height);

  const step = (2 * Math.PI) / numbers.length;
  for (let i = 0; i < numbers.length; i++) {
    let ang = i * step - Math.PI / 2 + rotation;
    let num = numbers[i];

    const x = radius * Math.cos(ang);
    const y = radius * Math.sin(ang);

    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(x, y);
    ctx.lineTo(x - pinWidth / 2, y);
    ctx.lineTo(x, y - pinWidth);
    ctx.closePath();

    ctx.fillStyle = i % 2 === 0 ? "#3498db" : "#f39c12";
    ctx.fill();

    ctx.fillStyle = "#fff";
    ctx.font = "24px Arial";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText(num.toString(), x - pinWidth / 2, y - pinWidth / 2);
  }
}

function getWinningNumber() {
  // Simulate a random winning number selection (replace with your logic)
  return Math.floor(Math.random() * numbers.length);
}

function showWinMessage(winningNumber) {
  const winMessage = document.getElementById("winMessage");
  const prizeAmount = document.getElementById("prizeAmount");
  prizeAmount.textContent = numbers[winningNumber];
  winMessage.style.display = "block";
}

function hideWinMessage() {
  const winMessage = document.getElementById("winMessage");
  winMessage.style.display = "none";
}

drawWheel(angle);
</script>

</body>
</html>
